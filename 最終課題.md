# 最終課題
## 学生管理システム

### チームメンバー

- k24019 [@taku3](https://github.com/taku3mi)
- k24039 [@Alicia4771](https://github.com/Alicia4771)
- k24056 [@ta-nu-13](https://github.com/ta-nu-13)
- k24100 [@kosuke361](https://github.com/kosuke361)
- k24103 [@conFess233](https://github.com/conFess233)

### 使用するもの
- Flask
- SQLite
>他のライブラリなど必要なものがあれば自由に追加してください。

### データベース
- 学生情報（学籍番号、名前、生年月日、性別、専攻）
- 教員情報（教員ID、名前、年齢、学科）
- 選科情報（学生のID、登録した科目）
- パスワード情報（ユーザID、パスワード）
- 成績情報（学籍番号、科目ID、単位、評価）
- 科目情報（科目ID、科目名、担当教師、専攻、単位区分、対象学年、単位数、曜日）
### ER図
```mermaid
erDiagram
    学生 ||--|| パスワード : 所有する
    教員 ||--|| パスワード : 所有する

    学生 ||--o{ 選科 : 登録する
    科目 ||--o{ 選科 : 選択される

    学生 ||--o{ 成績 : 取得する
    科目 ||--o{ 成績 : 評価される

    教員 ||--o{ 科目 : 担当する

    学生 {
        string 学籍番号
        string 名前
        date 生年月日
        string 性別
        string 専攻
    }

    教員 {
        string 教員ID
        string 名前
        date 生年月日
        string 学科
    }

    パスワード {
        string ユーザID
        string パスワード
    }

    科目 {
        int 科目ID
        string 科目名
        string 専攻
        string 単位区分
        int 対象学年
        int 単位数
        string 曜日
    }

    選科 {
        string 学籍番号
        int 科目ID
    }

    成績 {
        string 学籍番号
        int 科目ID
        int 単位
        int 評価
    }
```


### 機能要件
- ログイン機能（学生、教師共通）
- ユーザー情報の登録、修正、削除、検索
- 成績情報の登録、修正、削除、検索
- 科目情報の登録、修正、削除、検索
- 成績情報の集計（平均点、最高点、最低点）
- 成績情報の可視化（グラフや表形式での表示）
- 未来の成績の予測機能
- 全体/学生ごとの成績分析(得意、苦手など)

#### ユーザー権限
- 学生
    - 科目/ユーザーの一覧を見ることができる
    - 自分の成績を見ることができる
- 教師
    - 学生の成績を編集することができる。
    - 学生が登録した科目から削除できる
- スーパーユーザー
    - 全てのユーザー情報を管理することができる。
    - 全ての成績情報を管理することができる。
    - 全ての科目情報を管理することができる。


### 役割分担
| 役割 | 担当 |
| --- | --- |
| ログイン機能 | [@taku3](https://github.com/taku3mi) |
| 成績情報および成績に関する機能 | [@Alicia4771](https://github.com/Alicia4771) |
| 科目情報および科目に関する機能 | [@ta-nu-13](https://github.com/ta-nu-13) |
| ユーザー情報およびユーザーに関する機能 | [@kosuke361](https://github.com/kosuke361) |

| 役割 | 内容                                                                                                                                   |
| --- | --- |
| ログイン機能 | ユーザーIDとパスワードによるログイン処理<br>ユーザー種別（学生／教師）の判定<br>ログイン成功・失敗時の画面制御<br>ログアウト処理<br>セッション管理（ログイン状態の保持）<br>不正入力時のエラーメッセージ表示|
| 成績情報および成績に関する機能 | 成績情報の登録（教師）<br>成績情報の修正（教師）<br>成績情報の削除（教師）<br>学籍番号・科目名による成績検索<br>学生ごとの成績一覧表示<br>成績の平均点・最高点・最低点の算出<br>全体成績の統計処理<br>得意科目・苦手科目の分析<br>未来の成績予測処理<br>データベースからグラフ表示用のデータの集計（学籍番号、科目ID、単位x評価(int)）|
| 科目情報および科目に関する機能 | 科目情報の登録<br>科目情報の修正<br>科目情報の削除<br>科目一覧の表示<br>専攻・学年・曜日による科目検索<br>学生の選科（科目登録）処理<br>学生が登録した科目の削除（教師権限）<br>科目と担当教師の管理 |
| ユーザー情報およびユーザーに関する機能 | 学生情報の登録・修正・削除（スーパーユーザー）<br>教員情報の登録・修正・削除（スーパーユーザー）<br>ユーザー一覧の表示<br>名前・IDによるユーザー検索<br>ユーザー権限（学生／教師）の管理<br>学生は自分の情報のみ閲覧可能とする制御<br>教師は全ユーザー情報を管理可能とする制御<br>グラフ表示（科目ごとの評価、GPA）|


### ディレクトリの構成
- 必ず同じファイルで作成することではないです、ご参考にしてください。
- フォルダの構成だけ守ってください。
```
StudentManagementSystem/
- main.py
- database.db
├── static/
│   ├── css/
│   │   ├── base.css          # 全画面共通スタイル
│   │   ├── login.css         # ログイン画面用スタイル
│   │   ├── dashboard.css     # メイン画面用スタイル
│   │   ├── users.css         # ユーザー管理画面用
│   │   ├── subjects.css      # 科目管理画面用
│   │   ├── grades.css        # 成績管理画面用
│   │   └── charts.css        # グラフ表示用
│   │
│   ├── js/
│   │   ├── auth.js           # ログイン・ログアウト処理
│   │   ├── users.js          # ユーザー管理処理
│   │   ├── subjects.js       # 科目管理処理
│   │   ├── enrollments.js    # 選科処理
│   │   ├── grades.js         # 成績登録・更新
│   │   └── analytics.js      # グラフ描画（Chart.js）
│   │
│   └── img/
│       └── logo.png          # ロゴ画像など
│
├── templates/
│   ├── layout.html           # 共通レイアウト（ヘッダー・ナビ）
│   ├── login.html            # ログイン画面
│   ├── dashboard.html        # ログイン後トップ画面
│   │
│   ├── users/
│   │   ├── user_list.html    # ユーザー一覧
│   │   ├── user_detail.html  # ユーザー詳細
│   │   └── user_form.html    # 登録・編集画面
│   │
│   ├── subjects/
│   │   ├── subject_list.html # 科目一覧
│   │   └── subject_form.html # 科目登録・編集
│   │
│   ├── enrollments/
│   │   └── enrollment_list.html # 選科一覧
│   │
│   ├── grades/
│   │   ├── grade_list.html   # 成績一覧
│   │   └── grade_form.html   # 成績登録・編集
│   │
│   └── analytics/
│       ├── summary.html      # 成績統計表示
│       └── charts.html       # 成績グラフ表示
│
├── models/
│   ├── __init__.py
│   ├── user.py               # ユーザーモデル
│   ├── password.py           # パスワード情報モデル
│   ├── subject.py            # 科目モデル
│   ├── enrollment.py         # 選科モデル
│   └── grade.py              # 成績モデル
│
├── routes/
│   ├── __init__.py
│   ├── auth.py               # 認証（ログイン・ログアウト）
│   ├── users.py              # ユーザー管理
│   ├── subjects.py           # 科目管理
│   ├── enrollments.py        # 選科管理
│   ├── grades.py             # 成績管理
│   └── analytics.py          # 成績分析・統計
│
├── utils/
│   ├── auth.py               # 認証・権限判定処理
│   ├── db.py                 # データベース接続管理
│   ├── decorators.py         # ログイン必須デコレータ
│   └── validators.py         # 入力値チェック
...
```

### API構成
#### 概要
- APIはJSON形式で通信する。
- 認証はJWT（JSON Web Token）を使用する。
- エンドポイントは`/api/`から始まる。
- 各エンドポイントはHTTPメソッド（GET, POST）に対応する。
```
/api
 ├── auth        （認証関連）
 ├── users       （ユーザー管理）
 ├── subjects    （科目管理）
 ├── enrollments （選科管理）
 ├── grades      （成績管理）
 └── analytics   （成績分析）
```
**認証関連 API（auth）**
| メソッド | パス               | 内容            |
| ---- | ---------------- | ------------- |
| POST | /api/auth/login  | ログイン処理        |
| POST | /api/auth/logout | ログアウト処理       |
| GET  | /api/auth/me     | ログイン中ユーザー情報取得 |

**ユーザー管理 API（users）**
| メソッド | パス                | 内容        | 権限            |
| ---- | ----------------- | --------- | ------------- |
| GET  | /api/users        | ユーザー一覧・検索 | 教師 / スーパーユーザー |
| GET  | /api/users/detail | ユーザー詳細取得  | 全ユーザー         |
| POST | /api/users/create | ユーザー登録    | スーパーユーザー      |
| POST | /api/users/update | ユーザー情報更新  | スーパーユーザー      |
| POST | /api/users/delete | ユーザー削除    | スーパーユーザー      |

**学生管理 API（users/students）**
| メソッド | パス                | 内容        | 権限            |
| ---- | ----------------- | --------- | ------------- |
| GET  | /api/users/students | 学生一覧・条件検索 | 教師 / スーパーユーザー |


**科目管理 API（subjects）**
| メソッド | パス                   | 内容        | 権限            |
| ---- | -------------------- | --------- | ------------- |
| GET  | /api/subjects        | 科目一覧・条件検索 | 全ユーザー         |
| GET  | /api/subjects/detail | 科目詳細取得    | 全ユーザー         |
| POST | /api/subjects/create | 科目登録      | 教師 / スーパーユーザー |
| POST | /api/subjects/update | 科目情報更新    | 教師 / スーパーユーザー |
| POST | /api/subjects/delete | 科目削除      | 教師 / スーパーユーザー |

**選科管理 API（enrollments）**
| メソッド | パス                       | 内容        | 権限      |
| ---- | ------------------------ | --------- | ------- |
| POST | /api/enrollments/create  | 学生の科目登録   | 学生      |
| GET  | /api/enrollments/student | 学生の選科一覧取得 | 学生 / 教師 |
| POST | /api/enrollments/delete  | 学生の選科削除   | 教師      |

**成績管理 API（grades）**
| メソッド | パス                  | 内容       | 権限 |
| ---- | ------------------- | -------- | -- |
| GET  | /api/grades         | 成績検索     | 教師 |
| GET  | /api/grades/student | 学生成績一覧取得 | 学生 |
| POST | /api/grades/create  | 成績登録     | 教師 |
| POST | /api/grades/update  | 成績更新     | 教師 |
| POST | /api/grades/delete  | 成績削除     | 教師 |

**成績分析 API（analytics）**
| メソッド | パス                            | 内容            |
| ---- | ----------------------------- | ------------- |
| GET  | /api/analytics/grades/summary | 平均点・最高点・最低点算出 |
| GET  | /api/analytics/students       | 学生別成績分析       |
| GET  | /api/analytics/grades/chart   | グラフ表示用データ取得   |
| GET  | /api/analytics/grades/predict | 未来成績の予測       |


### コードの標準
#### コメント
- docstring: [Google Style](https://sphinxcontrib-napoleon.readthedocs.io/en/latest/example_google.html)（できるだけコメントつけましょう）
使用例
```
def calculate_average(scores: list[int]) -> float:
    """
    成績リストから平均点を計算する関数。

    Args:
        scores (list[int]): 成績のリスト

    Returns:
        float: 平均点
    """
    return sum(scores) / len(scores)
```
#### 命名規則
- 変数名、関数名、メソッド名、ファイル名
    -  [スネークケース (Snake Case)](https://qiita.com/uechi-shingo/items/d8f02ecdd8a535d6868e)
    - 単語をアンダースコア`_`で区切り、すべて小文字とする
使用例
```
student_name = "Tanaka"
total_score = 85

def get_student_score():
    pass
```

- クラス名
    - [パスカルケース](https://qiita.com/munepi0713/items/82ce7a56aa1b8233fd30)を使用する
    - 各単語の先頭を大文字にする
    - アンダースコアは使用しない
使用例
```
class Student:
    pass

class GradeManager:
    pass
```

- 定数
  - 定数は すべて大文字 + スネークケース を使用する
使用例
```
MAX_SCORE = 100
DEFAULT_TIMEOUT = 30
```


### イメージ図
#### 科目情報
![科目情報](./img/科目_img.jpg)


## テンプレート構成と使い方について

---

### base.html（全ページ共通のベース）

`base.html` は **すべてのページの最上位テンプレート**です。

### 主な役割
- HTML の基本構造（`<html>`, `<head>`, `<body>`）
- 共通 CSS（テーマ切り替えなど）
- 共通 JavaScript
- ダーク／ライトテーマ切り替え UI

### 定義されている主な block
- `title`：ページタイトル
- `head`：追加の CSS 読み込み
- `content`：ページの本文
- `scripts`：ページ固有の JavaScript

**基本的に直接編集せず、継承して使用します。**

---

### content_base.html（共通）

`content_base.html` は `base.html` を継承し、  
**ログイン後の画面共通レイアウト**を提供します。

### 含まれる要素
- サイドバー（ユーザー情報・ナビゲーション）
- ヘッダー（ページタイトル・日付）
- メインコンテンツ領域

### 主な block
- `nav_items`：役割ごとのメニュー項目
- `page_title`：ページ見出し
- `main_content`：各画面のメイン内容
- `extra_css`：画面固有の CSS

**管理者・学生・教員画面はすべてここを継承します。**

---

### admin.html / student.html / teacher.html（役割別画面）

これらのテンプレートはすべて  
`dashboard/dash_base.html` を継承しています。

### 役割
- ナビゲーションメニューの定義（`nav_items`）
- 内容の定義（`main_content`）
- 役割ごとの初期画面表示

### 例：継承構造
```jinja2
{% extends "content_base.html" %}
```

### 新しい画面を追加する場合
- dashboard/ 配下に新しい HTML を作成
- base.html を継承
- 必要な block のみ実装
```jinja2
{% extends "content_base.html" %}

{% block page_title %}新しい画面{% endblock %}

{% block main_content %}
  <div class="main-card">
    内容を書く
  </div>
{% endblock %}
```

