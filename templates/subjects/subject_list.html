{% extends active_template %}

{% block extra_css %}
    <link rel="stylesheet" href="{{ url_for('static', filename='css/list.css') }}">
    
    <style>
        /* 科目の種類を示すバッジ */
        .type-badge {
            display: inline-block;
            padding: 2px 8px;
            border-radius: 6px;
            font-size: 0.75rem;
            font-weight: 500;
        }
        
        /* 必修科目: 橙色/黄色 */
        .type-required {
            background-color: rgba(249, 115, 22, 0.1);
            color: #c2410c;
        }
        [data-theme="dark"] .type-required { color: #fb923c; }

        /* 選択科目: 蓝色 */
        .type-elective {
            background-color: rgba(14, 165, 233, 0.1);
            color: #0284c7;
        }
        [data-theme="dark"] .type-elective { color: #38bdf8; }

        .credit-num {
            font-weight: 600;
            color: var(--text-main);
        }
    </style>
{% endblock %}

{% block page_title %}科目管理{% endblock %}

{% block main_content %}
    <div class="list-card">
        
        <div class="list-header">
            <h2>{{ title }}</h2>
            <p>カリキュラムや担当教員、単位数を管理します。</p>
        </div>

        {% set current_type = request.args.get('type', 'all') %}
        <div class="filter-tabs">
            <a href="{{ url_for('subject.list', type='all') }}" 
               class="filter-tab {{ 'active' if current_type == 'all' else '' }}">
               すべて
            </a>
            <a href="{{ url_for('subject.list', type='required') }}" 
               class="filter-tab {{ 'active' if current_type == 'required' else '' }}">
               必修科目
            </a>
            <a href="{{ url_for('subject.list', type='elective') }}" 
               class="filter-tab {{ 'active' if current_type == 'elective' else '' }}">
               選択科目
            </a>
        </div>

        <div class="list-actions">
            <div class="search-box">
                <input type="text" placeholder="科目名、担当教員で検索...">
            </div>
            <a href="#" class="btn-add">
                <svg width="16" height="16" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><path d="M12 5v14M5 12h14"></path></svg>
                新規科目
            </a>
        </div>

        <div class="table-responsive">
            <table class="styled-table">
                <thead>
                    <tr>
                        <th width="100">科目ID</th>
                        <th>科目名</th>
                        <th>区分</th>
                        <th>単位数</th>
                        <th>担当教員</th>
                        <th>開講時期</th>
                        <th width="160">操作</th>
                    </tr>
                </thead>
                <tbody>
                    {% if subjects|length > 0 %}
                        {% for sub in subjects %}
                        <tr>
                            <td style="font-family: monospace;">{{ sub.id }}</td>
                            
                            <td style="font-weight: 500; color: var(--text-main);">
                                {{ sub.name }}
                            </td>

                            <td>
                                <span class="type-badge {{ 'type-required' if sub.type == 'required' else 'type-elective' }}">
                                    {{ '必修' if sub.type == 'required' else '選択' }}
                                </span>
                            </td>

                            <td>
                                <span class="credit-num">{{ sub.credits }}</span> 単位
                            </td>

                            <td>{{ sub.teacher }}</td>
                            
                            <td>
                                <span style="font-size: 0.85rem; color: var(--text-sub);">
                                    {{ sub.schedule }}
                                </span>
                            </td>

                            <td>
                                <div class="action-buttons">
                                    <a href="#" class="action-link edit-link">
                                        <svg width="14" height="14" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"></path><path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"></path></svg>
                                        編集
                                    </a>
                                    <a href="#" class="action-link delete-link">
                                        <svg width="14" height="14" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><polyline points="3 6 5 6 21 6"></polyline><path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"></path></svg>
                                        削除
                                    </a>
                                </div>
                            </td>
                        </tr>
                        {% endfor %}
                    {% else %}
                        <tr>
                            <td colspan="7" style="text-align: center; padding: 40px; color: #94a3b8;">
                                データが見つかりませんでした。
                            </td>
                        </tr>
                    {% endif %}
                </tbody>
            </table>
        </div>
    </div>
{% endblock %}