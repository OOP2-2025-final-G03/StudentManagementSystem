{% extends "base.html" %}

{% block title %}ログイン | {{title}}{% endblock %}

{% block head %}
    <link rel="stylesheet" href="{{ url_for('static', filename='css/login.css') }}">
{% endblock %}

{% block content %}
<div class="login-wrapper">
    <header class="header">
        <h1>{{title}}</h1>
        <p>ようこそ</p>
    </header>

    <main class="login-card">
        {% with messages = get_flashed_messages(with_categories=true) %}
            {% if messages %}
                {% for category, message in messages %}
                    <div class="alert alert-{{ category }}">{{ message }}</div>
                {% endfor %}
            {% endif %}
        {% endwith %}

        <form id="loginForm" action="{{ url_for('auth.login') }}" method="POST">
            <input type="hidden" name="role" value="{{ role }}">
            
            <div class="form-group">
                <label class="label" for="user_id">ユーザーId</label>
                <div class="input-wrapper">
                    <input type="text" id="user_id" name="user_id" class="input-field" placeholder="Idを入力してください" autocomplete="off" required>
                </div>
            </div>

            <div class="form-group">
                <label class="label" for="password">パスワード</label>
                <div class="input-wrapper">
                    <input type="password" id="password" name="password" class="input-field" placeholder="パスワードを入力してください" required>
                    
                    <button type="button" class="toggle-password" id="togglePasswordBtn">
                        <svg id="icon-eye-off" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <path d="M17.94 17.94A10.07 10.07 0 0 1 12 20c-7 0-11-8-11-8a18.45 18.45 0 0 1 5.06-5.94M9.9 4.24A9.12 9.12 0 0 1 12 4c7 0 11 8 11 8a18.5 18.5 0 0 1-2.16 3.19m-6.72-1.07a3 3 0 1 1-4.24-4.24"></path>
                            <line x1="1" y1="1" x2="23" y2="23"></line>
                        </svg>
                        <svg id="icon-eye-on" style="display:none;" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"></path>
                            <circle cx="12" cy="12" r="3"></circle>
                        </svg>
                    </button>
                </div>
            </div>

            <div class="options-row">
                <label class="checkbox-label">
                    <input type="checkbox" id="rememberMe">
                    <div class="custom-checkbox">
                        <svg viewBox="0 0 24 24"><polyline points="20 6 9 17 4 12"></polyline></svg>
                    </div>
                    <span>パスワードを記憶する</span>
                </label>

                <label class="checkbox-label">
                    <input type="checkbox" id="autoLogin">
                    <div class="custom-checkbox">
                        <svg viewBox="0 0 24 24"><polyline points="20 6 9 17 4 12"></polyline></svg>
                    </div>
                    <span>自動ログイン</span>
                </label>
            </div>

            <button type="submit" class="submit-btn">ログイン</button>

        </form>
    </main>
</div>
{% endblock %}

{% block scripts %}
<script>
    // パスワード表示切替機能
    const passwordInput = document.getElementById('password');
    const toggleBtn = document.getElementById('togglePasswordBtn');
    const iconOff = document.getElementById('icon-eye-off');
    const iconOn = document.getElementById('icon-eye-on');

    toggleBtn.addEventListener('click', function() {
        const type = passwordInput.getAttribute('type') === 'password' ? 'text' : 'password';
        passwordInput.setAttribute('type', type);
        
        if (type === 'text') {
            iconOff.style.display = 'none';
            iconOn.style.display = 'block';
            toggleBtn.style.color = 'var(--text-main)'; 
        } else {
            iconOff.style.display = 'block';
            iconOn.style.display = 'none';
            toggleBtn.style.color = 'var(--text-placeholder)'; 
        }
    });
</script>
{% endblock %}